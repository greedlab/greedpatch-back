{"version":3,"sources":["config/passport.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AACA;;;;AAEA,sBAAS,GAAT,CAAa,OAAb,EAAsB,4BAAa;AAC3B,mBAAe,OADY;AAE3B,mBAAe,QAFY;AAG3B,aAAS;AAHkB,CAAb;AAAA,gEAIf,iBAAe,QAAf,EAAyB,QAAzB,EAAmC,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAEwB,eAAK,OAAL,CAAa,EAAE,OAAO,QAAT,EAAb,CAFxB;;AAAA;AAEW,4BAFX;;AAAA,4BAGU,IAHV;AAAA;AAAA;AAAA;;AAAA,yDAIgB,KAAK,IAAL,EAAW,KAAX,CAJhB;;AAAA;AAAA;AAAA;AAAA,+BAO+B,KAAK,gBAAL,CAAsB,QAAtB,CAP/B;;AAAA;AAOe,+BAPf;;AAAA,4BAQc,OARd;AAAA;AAAA;AAAA;;AAAA,yDASoB,KAAK,IAAL,EAAW,KAAX,CATpB;;AAAA;AAWS,6BAAK,IAAL,EAAW,IAAX;AAXT;AAAA;;AAAA;AAAA;AAAA;;AAaS;;AAbT;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,yDAiBY,iBAjBZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAJe;;AAAA;AAAA;AAAA;AAAA,IAAtB,E,CARA","file":"config/passport.js","sourcesContent":["/**\n * Created by Bell on 16/8/10.\n */\n\nimport passport from 'koa-passport';\nimport User from '../models/user';\nimport { Strategy } from 'passport-local';\n\npassport.use('local', new Strategy({\n        usernameField: 'email',\n        passwordField: 'passwd',\n        session: false\n    }, async function(username, password, done) {\n        try {\n            const user = await User.findOne({ email: username });\n            if (!user) {\n                return done(null, false);\n            }\n            try {\n                const isMatch = await user.validatePassword(password);\n                if (!isMatch) {\n                    return done(null, false);\n                }\n                done(null, user);\n            } catch (err) {\n                done(err);\n            }\n\n        } catch (err) {\n            return done(err);\n        }\n    }\n));"],"sourceRoot":"/source/"}
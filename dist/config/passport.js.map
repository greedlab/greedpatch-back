{"version":3,"sources":["config/passport.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AACA;;AAEA;;;;AACA;;;;;;AACA,IAAM,QAAQ,oBAAU,kBAAI,IAAd,CAAd,C,CAVA;;;;AAYA,sBAAS,GAAT,CAAa,OAAb,EAAsB,4BAAa;AAC3B,mBAAe,OADY;AAE3B,mBAAe,UAFY;AAG3B,aAAS;AAHkB,CAAb;AAAA,gEAIf,iBAAe,KAAf,EAAsB,QAAtB,EAAgC,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAEwB,eAAK,OAAL,CAAa,EAAE,OAAO,KAAT,EAAb,CAFxB;;AAAA;AAEW,4BAFX;;AAAA,4BAGU,IAHV;AAAA;AAAA;AAAA;;AAAA,yDAIgB,KAAK,IAAL,EAAW,KAAX,CAJhB;;AAAA;AAAA;AAAA;AAAA,+BAO+B,KAAK,gBAAL,CAAsB,QAAtB,CAP/B;;AAAA;AAOe,+BAPf;;AAAA,4BAQc,OARd;AAAA;AAAA;AAAA;;AAAA,yDASoB,KAAK,IAAL,EAAW,KAAX,CATpB;;AAAA;AAWS,6BAAK,IAAL,EAAW,IAAX;AAXT;AAAA;;AAAA;AAAA;AAAA;;AAaS;AACA;;AAdT;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAiBK;AAjBL,yDAkBY,iBAlBZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAJe;;AAAA;AAAA;AAAA;AAAA,IAAtB","file":"config/passport.js","sourcesContent":["/**\n * Created by Bell on 16/8/10.\n */\n\nimport passport from 'koa-passport';\nimport User from '../models/user';\nimport { Strategy } from 'passport-local';\n\nimport Debug from 'debug';\nimport pkg from '../../package.json';\nconst debug = new Debug(pkg.name);\n\npassport.use('local', new Strategy({\n        usernameField: 'email',\n        passwordField: 'password',\n        session: false\n    }, async function(email, password, done) {\n        try {\n            const user = await User.findOne({ email: email });\n            if (!user) {\n                return done(null, false);\n            }\n            try {\n                const isMatch = await user.validatePassword(password);\n                if (!isMatch) {\n                    return done(null, false);\n                }\n                done(null, user);\n            } catch (err) {\n                debug(err);\n                done(err);\n            }\n        } catch (err) {\n            debug(err);\n            return done(err);\n        }\n    }\n));"],"sourceRoot":"/source/"}
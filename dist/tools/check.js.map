{"version":3,"sources":["tools/check.js"],"names":[],"mappings":";;;;;QAMgB,e,GAAA,e;QAkBA,e,GAAA,e;QAkBA,kB,GAAA,kB;QAkBA,kB,GAAA,kB;QAkBA,oB,GAAA,oB;QAOA,iB,GAAA,iB;;AAjFhB;;IAAY,K;;;;AAEL,SAAS,eAAT,CAAyB,GAAzB,EAA8B,KAA9B,EAAqC;AACxC,QAAI,CAAC,KAAL,EAAY;AACR,YAAI,MAAJ,GAAa,GAAb;AACA,YAAI,IAAJ,GAAW;AACP,qBAAS,iBADF;AAEP,oBAAQ,CACJ;AACI,4BAAY,MADhB;AAEI,yBAAS,OAFb;AAGI,wBAAQ;AAHZ,aADI;AAFD,SAAX;AAUA,eAAO,KAAP;AACH;AACD,WAAO,IAAP;AACH,C,CAtBD;;;;AAwBO,SAAS,eAAT,CAAyB,GAAzB,EAA8B,KAA9B,EAAqC;AACxC,QAAI,CAAC,MAAM,UAAN,CAAiB,KAAjB,CAAL,EAA8B;AAC1B,YAAI,MAAJ,GAAa,GAAb;AACA,YAAI,IAAJ,GAAW;AACP,qBAAS,eADF;AAEP,oBAAQ,CACJ;AACI,0BAAU,MADd;AAEI,uBAAO,OAFX;AAGI,sBAAM;AAHV,aADI;AAFD,SAAX;AAUA,eAAO,KAAP;AACH;AACD,WAAO,IAAP;AACH;;AAEM,SAAS,kBAAT,CAA4B,GAA5B,EAAiC,QAAjC,EAA2C;AAC9C,QAAI,CAAC,QAAL,EAAe;AACX,YAAI,MAAJ,GAAa,GAAb;AACA,YAAI,IAAJ,GAAW;AACP,qBAAS,oBADF;AAEP,oBAAQ,CACJ;AACI,4BAAY,MADhB;AAEI,yBAAS,UAFb;AAGI,wBAAQ;AAHZ,aADI;AAFD,SAAX;AAUA,eAAO,KAAP;AACH;AACD,WAAO,IAAP;AACH;;AAEM,SAAS,kBAAT,CAA4B,GAA5B,EAAiC,QAAjC,EAA2C;AAC9C,QAAI,CAAC,MAAM,aAAN,CAAoB,QAApB,CAAL,EAAoC;AAChC,YAAI,MAAJ,GAAa,GAAb;AACA,YAAI,IAAJ,GAAW;AACP,qBAAS,kBADF;AAEP,oBAAQ,CACJ;AACI,0BAAU,MADd;AAEI,uBAAO,UAFX;AAGI,sBAAM;AAHV,aADI;AAFD,SAAX;AAUA,eAAO,KAAP;AACH;AACD,WAAO,IAAP;AACH;;AAEM,SAAS,oBAAT,CAA8B,GAA9B,EAAmC;AACtC,QAAI,MAAJ,GAAa,GAAb;AACA,QAAI,IAAJ,GAAW;AACP,iBAAS;AADF,KAAX;AAGH;;AAEM,SAAS,iBAAT,CAA2B,GAA3B,EAAgC;AACnC,QAAI,MAAJ,GAAa,GAAb;AACA,QAAI,IAAJ,GAAW;AACP,iBAAS,qBADF;AAEP,gBAAQ,CACJ;AACI,wBAAY,MADhB;AAEI,qBAAS,OAFb;AAGI,oBAAQ;AAHZ,SADI;AAFD,KAAX;AAUH","file":"tools/check.js","sourcesContent":["/**\n * Created by Bell on 16/8/30.\n */\n\nimport * as regex from '../utils/regex';\n\nexport function checkEmptyEmail(ctx, email) {\n    if (!email) {\n        ctx.status = 422;\n        ctx.body = {\n            message: 'Email not found',\n            errors: [\n                {\n                    'resource': 'User',\n                    'field': 'email',\n                    'code': 'missing_field'\n                }\n            ]\n        };\n        return false;\n    }\n    return true;\n}\n\nexport function checkValidEmail(ctx, email) {\n    if (!regex.validEmail(email)) {\n        ctx.status = 422;\n        ctx.body = {\n            message: 'Invalid email',\n            errors: [\n                {\n                    resource: 'User',\n                    field: 'email',\n                    code: 'invalid'\n                }\n            ]\n        };\n        return false;\n    }\n    return true;\n}\n\nexport function checkEmptyPassword(ctx, password) {\n    if (!password) {\n        ctx.status = 422;\n        ctx.body = {\n            message: 'Password not found',\n            errors: [\n                {\n                    'resource': 'User',\n                    'field': 'password',\n                    'code': 'missing_field'\n                }\n            ]\n        };\n        return false;\n    }\n    return true;\n}\n\nexport function checkValidPassword(ctx, password) {\n    if (!regex.validPassword(password)) {\n        ctx.status = 422;\n        ctx.body = {\n            message: 'Invalid password',\n            errors: [\n                {\n                    resource: 'User',\n                    field: 'password',\n                    code: 'invalid'\n                }\n            ]\n        };\n        return false;\n    }\n    return true;\n}\n\nexport function authenticationFailed(ctx) {\n    ctx.status = 401;\n    ctx.body = {\n        message: 'Email or password error'\n    };\n}\n\nexport function emailIsNotExisted(ctx) {\n    ctx.status = 422;\n    ctx.body = {\n        message: 'User is not existed',\n        errors: [\n            {\n                'resource': 'User',\n                'field': 'email',\n                'code': 'missing_field'\n            }\n        ]\n    };\n}\n"],"sourceRoot":"/source/"}
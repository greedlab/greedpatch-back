{"version":3,"sources":["routes/file.js"],"names":[],"mappings":";;;;;;AAKA;;;;AACA;;;;AAEA;;IAAY,I;;AACZ;;IAAY,I;;AAEZ;;;;AAEA;;;;AACA;;;;;;;;AAdA;;;;AAIA,IAAM,SAAS,QAAQ,YAAR,CAAf;;AAWA,IAAM,QAAQ,oBAAU,kBAAI,IAAd,CAAd;;AAGA,IAAI,WAAW,QAAf;AACA,IAAI,SAAS,IAAI,MAAJ,CAAW,EAAE,QAAQ,QAAV,EAAX,CAAb;;AAEA,IAAM,aAAa,eAAK,IAAL,CAAU,SAAV,EAAoB,kBAApB,CAAnB;AACA,IAAM,UAAU,oBAAO,WAAP,CAAmB;AAC/B,iBAAa,qBAAU,GAAV,EAAe,IAAf,EAAqB,EAArB,EAAyB;AAClC,WAAG,IAAH,EAAS,UAAT;AACH,KAH8B;AAI/B,cAAU,kBAAU,GAAV,EAAe,IAAf,EAAqB,EAArB,EAAyB;AAC/B,WAAG,IAAH,EAAS,KAAK,GAAL,KAAa,GAAb,GAAmB,KAAK,YAAjC;AACH;AAN8B,CAAnB,CAAhB;;AASA,IAAM,SAAS,yBAAO,EAAE,SAAS,OAAX,EAAP,CAAf;;AAEA,OACK,IADL,CACU,GADV,EACe,KAAK,UADpB,EACgC,OAAO,MAAP,CAAc,MAAd,CADhC,EACuD,KAAK,MAD5D;AAEI;AACA;;kBAEW;AACX,sBADW;AAEX,YAAQ;AAFG,C","file":"routes/file.js","sourcesContent":["/**\n * Created by Bell on 16/9/1.\n */\n\nconst Router = require('koa-router');\nimport path from 'path';\nimport cors from 'koa-cors';\n\nimport * as auth from '../tools/auth';\nimport * as file from '../controllers/file';\n\nimport multer from 'koa-multer';\n\nimport Debug from 'debug';\nimport pkg from '../../package.json';\nconst debug = new Debug(pkg.name);\n\n\nlet base_url = '/files';\nlet router = new Router({ prefix: base_url });\n\nconst upload_dir = path.join(__dirname,'../assets/files/');\nconst storage = multer.diskStorage({\n    destination: function (req, file, cb) {\n        cb(null, upload_dir);\n    },\n    filename: function (req, file, cb) {\n        cb(null, Date.now() + '-' + file.originalname);\n    }\n});\n\nconst upload = multer({ storage: storage });\n\nrouter\n    .post('/', auth.ensureUser, upload.single('file'), file.upload);\n    // .post('/', cors(), upload.single('file'), file.upload);\n    // .post('/', upload.single('file'), file.upload);\n\nexport default {\n    base_url,\n    router: router\n};"],"sourceRoot":"/source/"}
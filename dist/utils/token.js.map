{"version":3,"sources":["utils/token.js"],"names":[],"mappings":";;;;;QAOgB,a,GAAA,a;QAQA,uB,GAAA,uB;QAOA,wB,GAAA,wB;;AAlBhB;;;;AACA;;;;;;AALA;;;;AAOO,SAAS,aAAT,CAAuB,EAAvB,EAA2B;AAC9B,QAAM,OAAO,IAAb;AACA,QAAM,MAAM,KAAK,GAAL,EAAZ;AACA,QAAM,MAAM,MAAM,KAAK,EAAL,GAAU,EAAV,GAAe,EAAf,GAAoB,IAAtC;AACA,QAAM,QAAQ,SAAd;AACA,WAAO,uBAAI,IAAJ,CAAS,EAAC,QAAD,EAAM,QAAN,EAAW,MAAX,EAAe,YAAf,EAAT,EAAgC,iBAAO,KAAvC,CAAP;AACH;;AAEM,SAAS,uBAAT,CAAiC,EAAjC,EAAqC;AACxC,QAAM,OAAO,IAAb;AACA,QAAM,MAAM,KAAK,GAAL,EAAZ;AACA,QAAM,QAAQ,aAAd;AACA,WAAO,uBAAI,IAAJ,CAAS,EAAC,QAAD,EAAM,MAAN,EAAU,YAAV,EAAT,EAA2B,iBAAO,KAAlC,CAAP;AACH;;AAEM,SAAS,wBAAT,CAAkC,EAAlC,EAAsC;AACzC,QAAM,OAAO,IAAb;AACA,QAAM,MAAM,KAAK,GAAL,EAAZ;AACA,QAAM,MAAM,MAAM,KAAK,EAAL,GAAU,EAAV,GAAe,IAAjC;AACA,QAAM,QAAQ,KAAd;AACA,WAAO,uBAAI,IAAJ,CAAS,EAAC,QAAD,EAAM,QAAN,EAAW,MAAX,EAAe,YAAf,EAAT,EAAgC,iBAAO,KAAvC,CAAP;AACH","file":"utils/token.js","sourcesContent":["/**\n * Created by Bell on 16/8/26.\n */\n\nimport jwt from 'jsonwebtoken';\nimport config from '../config';\n\nexport function generateToken(id) {\n    const user = this;\n    const iat = Date.now();\n    const exp = iat + 30 * 24 * 60 * 60 * 1000;\n    const scope = 'default';\n    return jwt.sign({iat, exp, id, scope}, config.token);\n};\n\nexport function generateCheckPatchToken(id) {\n    const user = this;\n    const iat = Date.now();\n    const scope = 'patch:check';\n    return jwt.sign({iat, id, scope}, config.token);\n};\n\nexport function generateSetPasswordToken(id) {\n    const user = this;\n    const iat = Date.now();\n    const exp = iat + 24 * 60 * 60 * 1000;\n    const scope = 'all';\n    return jwt.sign({iat, exp, id, scope}, config.token);\n};\n"],"sourceRoot":"/source/"}